<section class="dashboard">
  <header class="dashboard__header">
    <h1>{{ 'nav.dashboard' | i18n }}</h1>
    <p>Resumen de pipeline y actividades.</p>
  </header>

  @if (kpi$ | async; as kpi) {
    <div class="dashboard__grid">
      <app-kpi-card
        label="Oportunidades abiertas"
        [value]="kpi.abiertas"
        trend="up"
        helper="vs. semana anterior"
      ></app-kpi-card>
      <app-kpi-card
        label="Monto total"
        [value]="(kpi.total | currency:'USD') || ''"
        trend="up"
        helper="+12%"
      ></app-kpi-card>
      <app-kpi-card
        label="Win rate"
        [value]="(kpi.winRate | percent:'1.0-0') || ''"
        trend="flat"
      ></app-kpi-card>
      <app-kpi-card
        label="PrÃ³ximas actividades"
        [value]="kpi.proximas"
        trend="down"
        helper="para hoy"
      ></app-kpi-card>
    </div>
  }

  <div class="dashboard__charts">
    <app-mini-chart type="bar" [values]="[4, 8, 6, 12, 9, 14]"></app-mini-chart>
    <app-mini-chart type="line" [values]="[120, 180, 160, 220, 260, 280]"></app-mini-chart>
    <app-mini-chart type="donut" [values]="[45, 30, 25]"></app-mini-chart>
  </div>

  <section class="dashboard__activities" aria-labelledby="activitiesTitle">
    <div class="dashboard__activities-header">
      <h2 id="activitiesTitle">{{ 'dashboard.activities' | i18n }}</h2>
      <button type="button">Marcar todas</button>
    </div>
    @if (activities$ | async; as activities) {
      <app-data-table
        [columns]="columns"
        [data]="activities"
        [pageSize]="10"
        density="compact"
        [enableInlineEdit]="false"
      ></app-data-table>
    }
  </section>
</section>
